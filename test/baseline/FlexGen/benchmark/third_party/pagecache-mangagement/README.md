ported from https://code.google.com/archive/p/pagecache-mangagement/source/default/source
